# ğŸ æ°´æœè­‰äº¤æ‰€ PRO (Fruit Stock Exchange System)

é€™æ˜¯ä¸€å€‹çµåˆ **AI ç”Ÿæˆå…§å®¹** èˆ‡ **å³æ™‚æ¨¡æ“¬å¸‚å ´** çš„è‚¡ç¥¨äº¤æ˜“éŠæˆ²ç³»çµ±ã€‚
ç³»çµ±é€éè¤‡é›œçš„æ¼”ç®—æ³•æ¨¡æ“¬çœŸå¯¦å¸‚å ´çš„æ³¢å‹•ï¼Œä¸¦åˆ©ç”¨ Google Gemini AI å‹•æ…‹ç”Ÿæˆè²¡ç¶“æ–°èã€å°ˆå®¶é æ¸¬èˆ‡æ–°å…¬å¸ IPOã€‚

---

## ğŸ› ï¸ æŠ€è¡“æ¶æ§‹ (Tech Stack)

### Backend (å¾Œç«¯)
- **Framework**: Python FastAPI (Async)
- **Database**: PostgreSQL (SQLModel ORM)
- **Cache / IPC**: Redis (ç”¨æ–¼ Pub/Sub å³æ™‚è¡Œæƒ…å»£æ’­)
- **AI**: Google Gemini Pro/Flash API
- **Scheduler**: APScheduler (è™•ç†é€±ä¸€ IPOã€å®šæ™‚ä»»å‹™)

### Frontend (å‰ç«¯)
- **Framework**: React 18 (Vite)
- **UI Lib**: TailwindCSS, Shadcn/UI, Lucide Icons
- **Charts**: Lightweight-Charts (TradingView)
- **State**: Context API + WebSocket (useSocket)

### DevOps
- **Docker**: å®Œæ•´å®¹å™¨åŒ–éƒ¨ç½² (Backend, Frontend-Nginx, Postgres, Redis)
- **Nginx**: åå‘ä»£ç†èˆ‡éœæ…‹è³‡æºæœå‹™

---

## âš™ï¸ æ ¸å¿ƒæ©Ÿåˆ¶è©³è§£ (Core Mechanics)

### 1. ğŸ“ˆ å¸‚å ´å¼•æ“ (Market Engine)

å¸‚å ´ä¸¦éå–®ç´”çš„éš¨æ©Ÿæ•¸ï¼Œè€Œæ˜¯èåˆäº†å¤šç¨®å› å­çš„ç‰©ç†æ¨¡æ“¬ï¼š

*   **åŸºç¤æ³¢å‹• (Volatility)**ï¼šæ¯æª”è‚¡ç¥¨æ“æœ‰ä¸åŒçš„åŸºç¤æ³¢å‹•ç‡ï¼Œæ¨¡æ“¬å¹¾ä½•å¸ƒæœ—é‹å‹• (GBM)ã€‚
*   **æ–°èè¡æ“Š (Event Impact)**ï¼š
    *   AI ç”Ÿæˆçš„åˆ©å¤š/åˆ©ç©ºæ–°èæœƒçµ¦äºˆè‚¡åƒ¹ä¸€å€‹ã€Œå‹•é‡ (Momentum)ã€ã€‚
    *   **æ··æ²Œæ¨¡å¼**ï¼šç•¶çŸ­æ™‚é–“å…§ç™¼ç”Ÿå¤§é‡æ–°è (Impact > 0.15)ï¼Œè‚¡ç¥¨å°‡é€²å…¥ã€Œé«˜æ³¢å‹•æ¨¡å¼ã€ï¼ŒæŒ¯å¹…æ“´å¤§ 5 å€ã€‚
*   **ç‹™æ“Šæ‰‹å› å­ (Sniper Move)**ï¼šæ¥µä½æ©Ÿç‡ (0.02%) å‡ºç¾çš„ç¬é–“è·³æ¼²/è·³è·Œï¼Œæ¨¡æ“¬èƒ–æ‰‹æŒ‡æˆ–å…§ç·šäº¤æ˜“ã€‚
*   **åœ°å¿ƒå¼•åŠ› (Gravity)**ï¼š
    *   **Overvalued (>1.5x)**ï¼šè‚¡åƒ¹éé«˜æ™‚æœƒå—åˆ°åœ°å¿ƒå¼•åŠ›æ‹‰å›ã€‚
    *   **Undervalued (<0.7x)**ï¼šè‚¡åƒ¹éä½æ™‚æœƒæœ‰åƒ¹å€¼æŠ•è³‡è²·ç›¤æ”¯æ’ã€‚
    *   **FOMO/Panic**ï¼šä½†åœ¨æ¥µç«¯ç‹€æ³ä¸‹ï¼Œæœ‰æ©Ÿç‡è§¸ç™¼ã€Œè¿½æ¼²æ®ºè·Œã€æ©Ÿåˆ¶ï¼Œæš«æ™‚ç„¡è¦–å¼•åŠ›ã€‚

### 2. ğŸ¤– AI å°ˆå®¶é æ¸¬ç³»çµ± (Guru System)

*   **äº”å¤§æ€§æ ¼å°ˆå®¶**ï¼š
    *   ğŸº **è¯çˆ¾è¡—ä¹‹ç‹¼** (æ¿€é€²å¤šé ­)
    *   ğŸ”® **æ°´æ™¶çƒå©†å©†** (ç„å­¸ç©ºé ­)
    *   ğŸ¤– **AI é‡åŒ–æ©Ÿå™¨äºº** (æ•¸æ“šæµ)
    *   ğŸ‘´ **ç©©å¥è€ç‹** (ä¿å®ˆæ´¾)
    *   ğŸ”— **å€å¡Šéˆä¿¡ä»°è€…** (ç§‘æŠ€ç‹‚ç†±)
*   **è‡ªæˆ‘å¯¦ç¾é è¨€ (Self-Fulfilling Prophecy)**ï¼š
    *   ç•¶å°ˆå®¶ç™¼å¸ƒé æ¸¬ (Bull/Bear) æ™‚ï¼Œæœƒç”¢ç”Ÿå¾®å¹…çš„ã€Œå°ˆå®¶æ¼‚ç§» (Guru Drift)ã€åŠ›é“ï¼Œæ¨å‹•è‚¡åƒ¹å¾€é æ¸¬æ–¹å‘ç§»å‹•ã€‚
    *   **å‘½ä¸­çå‹µ**ï¼šè‹¥è‚¡åƒ¹çœŸçš„é”åˆ°ç›®æ¨™åƒ¹ï¼ŒAI æœƒç”Ÿæˆã€Œå°ˆå®¶ç¥æº–é è¨€ã€çš„æ–°èï¼Œä¸¦å°è‚¡åƒ¹é€ æˆäºŒæ¬¡è¡æ“Šã€‚

### 3. ğŸ“‰ ç ´ç”¢èˆ‡é‡çµ„ (Bankruptcy & Rebrand)

*   **è§¸ç™¼æ¢ä»¶**ï¼šç•¶è‚¡åƒ¹ä½æ–¼ **$0.05** æ™‚ï¼Œå…¬å¸å®£å‘Šç ´ç”¢ã€‚
*   **å¾Œæœ**ï¼š
    *   æ‰€æœ‰æŒæœ‰è©²è‚¡ç¥¨çš„ç©å®¶ï¼ŒæŒå€‰æ­¸é›¶ (å£ç´™)ã€‚
    *   **AI é‡çµ„**ï¼šç³»çµ±ç«‹å³å‘¼å« Gemini AIï¼Œç”Ÿæˆä¸€å®¶å…¨æ–°çš„å…¬å¸ (åç¨±ã€ä»£è™Ÿ)ï¼Œä¸¦åœ¨åŸåƒ¹ä½é™„è¿‘é‡æ–°ä¸Šå¸‚ (Re-IPO)ã€‚

### 4. ğŸ‰ æ–°è‚¡ä¸Šå¸‚ (Weekly IPO)

*   **è§¸ç™¼æ™‚é–“**ï¼šæ¯é€±ä¸€æ—©ä¸Š 9:00ã€‚
*   **æ©Ÿç‡**ï¼š5% æ©Ÿç‡è§¸ç™¼ã€‚
*   **æµç¨‹**ï¼šAI ç”Ÿæˆä¸€å®¶å…¨æ–°å…¬å¸ï¼Œçµ¦äºˆè¼ƒé«˜çš„åˆå§‹æ³¢å‹•ç‡ï¼Œä¸¦ç™¼å¸ƒã€Œæ–°è‚¡ä¸Šå¸‚ã€å…¬å‘Šï¼Œå¸å¼•è³‡é‡‘ç‚’ä½œã€‚

---

## ğŸ’° ç©å®¶èˆ‡äº¤æ˜“ç³»çµ±

### 1. è³‡ç”¢è¨ˆç®—
*   **æ·¨å€¼ (Net Worth)** = ç¾é‡‘ (Balance) + è‚¡ç¥¨å¸‚å€¼ (Stock Value)ã€‚
*   **å³æ™‚æ›´æ–°**ï¼šå‰ç«¯é€é WebSocket æ¥æ”¶å³æ™‚å ±åƒ¹ï¼Œå‹•æ…‹è¨ˆç®—ç¸½è³‡ç”¢ï¼Œç„¡éœ€é »ç¹åˆ·æ–° APIã€‚

### 2. äº¤æ˜“é™åˆ¶
*   **è²·å…¥**ï¼šé¤˜é¡ä¸è¶³æ™‚å›å‚³ 200 (é™„å¸¶ Error Status)ï¼Œå‰ç«¯é¡¯ç¤ºç´…è‰²è­¦å‘Šã€‚
*   **è³£å‡º**ï¼šæŒè‚¡ä¸è¶³æ™‚å›å‚³ 200 (é™„å¸¶ Error Status)ï¼Œå‰ç«¯é¡¯ç¤ºç´…è‰²è­¦å‘Šã€‚
*   **T+0**ï¼šç›®å‰è¨­å®šç‚ºå³æ™‚äº¤å‰²ï¼Œè²·å…¥å¾Œå¯ç«‹å³è³£å‡ºã€‚

### 3. ç”¨æˆ¶é«”é©—å„ªåŒ–
*   **è¨»å†Š/ç™»å…¥**ï¼š
    *   å˜—è©¦è¨»å†Šå·²å­˜åœ¨å¸³è™Ÿ -> å¼•å°å»ç™»å…¥ (200 OK)ã€‚
    *   å˜—è©¦ç™»å…¥ä¸å­˜åœ¨å¸³è™Ÿ -> å¼•å°å»è¨»å†Š (200 OK)ã€‚
    *   å¯†ç¢¼éŒ¯èª¤ -> å‹å–„æç¤º (200 OK)ã€‚
*   **è·‘é¦¬ç‡ˆ (Ticker)**ï¼š
    *   ç´…ç‡ˆğŸ”´ï¼šç³»çµ±æ–·ç·šä¸­ã€‚
    *   ç¶ ç‡ˆğŸŸ¢ï¼šç³»çµ±æ­£å¸¸ã€‚
    *   é»ƒå­—âš ï¸ï¼šé‡å¤§å¸‚å ´å¿«è¨Šã€‚
    *   **é€šçŸ¥é˜²é‡ (Deduplication)**ï¼šå‰ç«¯å¯¦ä½œäº† `useRef` ç´€éŒ„æœ€å¾Œä¸€æ¬¡äº‹ä»¶ IDï¼Œé˜²æ­¢å›  WebSocket é »ç¹æ›´æ–°å°è‡´åŒä¸€å‰‡æ–°èé‡è¤‡å½ˆå‡º Toast é€šçŸ¥ã€‚

---

## ğŸš€ éƒ¨ç½²èˆ‡åŸ·è¡Œ

### ç’°å¢ƒè®Šæ•¸ (.env)
```ini
GEMINI_API_KEY=your_key_here
DATABASE_URL=postgresql://user:password@postgres:5432/stock_sim
REDIS_URL=redis://redis:6379/0
```

### Docker å•Ÿå‹• (æ¨è–¦)
```bash
# åŒ…å« DB, Redis, Backend, Frontend
docker-compose up --build
```
- Frontend: `http://localhost:3002` (æˆ– NAS IP:3002)
- Backend API: å…§éƒ¨ä¸²æ¥ï¼Œå¤–éƒ¨ä¸å¯è¦‹ (é€é Nginx Proxy `/api`)

### ğŸ”„ å¦‚ä½•æ›´æ–°ç¨‹å¼ç¢¼ (ä¸å½±éŸ¿è³‡æ–™åº«)
ç”±æ–¼è³‡æ–™åº«ä½¿ç”¨ Docker Volume (`postgres_data`) æ›è¼‰ï¼Œ**é‡å»ºå®¹å™¨ä¸¦ä¸æœƒæ¸…é™¤è³‡æ–™**ã€‚
è‹¥æ‚¨ä¿®æ”¹äº†å‰ç«¯æˆ–å¾Œç«¯ç¨‹å¼ç¢¼ï¼Œåªéœ€å†æ¬¡åŸ·è¡Œï¼š
```bash
docker-compose up --build -d
```
ç³»çµ±æœƒè‡ªå‹•ï¼š
1. **ä¿ç•™** è³‡æ–™åº«è³‡æ–™ (è‚¡ç¥¨ã€ç”¨æˆ¶è³‡ç”¢)ã€‚
2. **é‡å»º** å¾Œç«¯èˆ‡å‰ç«¯é¡åƒ (å¥—ç”¨æ–°ç¨‹å¼ç¢¼)ã€‚
3. **é‡å•Ÿ** æœå‹™ã€‚

è‹¥åªè¦æ›´æ–°ç‰¹å®šæœå‹™ (ä¾‹å¦‚åªæ”¹äº†å‰ç«¯)ï¼š
```bash
docker-compose up --build -d frontend
```

### æœ¬åœ°é–‹ç™¼ (Local Dev)
```bash
# Backend
cd backend
uv run uvicorn main:app --reload --port 8080

# Frontend
cd frontend
npm run dev
# Access: http://localhost:3002
```

---

## ğŸ“‚ ç›®éŒ„çµæ§‹
- `backend/market.py`: å¸‚å ´æ ¸å¿ƒç‰©ç†å¼•æ“ã€‚
- `backend/ai_service.py`: Gemini AI ä¸²æ¥é‚è¼¯ã€‚
- `backend/trader.py`: äº¤æ˜“æ“åˆé‚è¼¯ã€‚
- `frontend/src/context/SocketContext.jsx`: WebSocket å³æ™‚é€£ç·šç®¡ç†ã€‚
- `frontend/src/components/charts/`: Kç·šåœ–çµ„ä»¶ (Wrapper for Lightweight-charts).
